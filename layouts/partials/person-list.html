{{/* 
  person-list.html
  Renders a list of people from a front matter param.
  Usage:
    {{ partial "person-list.html" (dict "page" . "param" "authors") }}
*/}}

{{ $page := .page }}
{{ $param := .param }}

{{ with $page.Params }}
  {{ $people := index . $param }}
  {{ if $people }}
    <div class="people-list">
      {{ range $people }}
        {{ $person := site.GetPage (printf "people/%s" .) }}
        <div class="person">
          {{ with $person }}
            {{ $imgParam := $person.Params.image }}
            {{ if $imgParam }}
              {{ $pimg := $person.Resources.GetMatch (printf "*%s" $imgParam) }}
              {{ if $pimg }}
                <img src="{{ $pimg.RelPermalink }}" alt="{{ $person.Title }}">
              {{ else }}
                <img src="{{ $imgParam | relURL }}" alt="{{ $person.Title }}">
              {{ end }}
            {{ else }}
              {{ with site.GetPage "people" }}
                {{ with .Resources.GetMatch "avatar-blank.*" }}
                  <img src="{{ .RelPermalink }}" alt="{{ $person.Title }}">
                {{ end }}
              {{ end }}
            {{ end }}
            <p class="name">
              <a href="{{ $person.RelPermalink }}">{{ $person.Title }}</a>
            </p>
            {{ if .Params.roles }}
              <p class="role">{{ delimit .Params.roles ", " }}</p>
            {{ else if .Params.role }}
              <p class="role">{{ .Params.role }}</p>
            {{ end }}
          {{ else }}
            {{ $pretty := . | replace "-" " " | title }}
            <p class="name">{{ $pretty }}</p>
          {{ end }}
        </div>
      {{ end }}
    </div>
  {{ end }}
{{ end }}


{{/*  
Example usage in a post template:
<article>
  <h1>{{ .Title }}</h1>

  {{ partial "person-list.html" (dict "page" . "param" "authors") }}

  <div class="content">
    {{ .Content }}
  </div>
</article>

Example usage in a event template:

<h1>{{ .Title }}</h1>
<p>{{ .Date.Format "Jan 2, 2006" }}</p>

<h2>Speakers</h2>
{{ partial "person-list.html" (dict "page" . "param" "speakers") }}

<h2>Organizers</h2>
{{ partial "person-list.html" (dict "page" . "param" "organizers") }}


  */}}
